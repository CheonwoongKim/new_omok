<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>오목 게임 - Interactive</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .game-board {
            background: radial-gradient(circle at center, #fefefe 0%, #f5f5f5 100%);
        }
        .grid-line-h {
            position: absolute;
            height: 1px;
            background-color: #333;
            width: 100%;
        }
        .grid-line-v {
            position: absolute;
            width: 1px;
            background-color: #333;
            height: 100%;
        }
        .intersection {
            position: absolute;
            width: 40px;
            height: 40px;
            cursor: pointer;
            border-radius: 50%;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .intersection:hover:not(.occupied) {
            background-color: rgba(0,0,0,0.1);
        }
        .intersection.occupied {
            cursor: not-allowed;
        }
        .stone {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }
        .black-stone {
            background: radial-gradient(circle at 30% 30%, #666, #000);
        }
        .white-stone {
            background: radial-gradient(circle at 30% 30%, #fff, #ddd);
            border: 1px solid #999;
        }
        .star-point {
            position: absolute;
            width: 6px;
            height: 6px;
            background-color: #333;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .winning-stone {
            animation: pulse 1s infinite;
            box-shadow: 0 0 20px #ff6b6b;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .game-over-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .turn-indicator {
            transition: all 0.3s ease;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-100 to-gray-200 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-5xl font-light text-gray-800 mb-2">OMOK</h1>
            <div class="w-16 h-1 bg-gray-800 mx-auto"></div>
        </div>
        
        <div class="flex flex-col xl:flex-row gap-8 justify-center items-start">
            <!-- Game Board -->
            <div class="flex-shrink-0">
                <div class="game-board relative p-8 rounded-3xl shadow-2xl border border-gray-300" style="width: 640px; height: 640px;">
                    <!-- Grid Lines -->
                    <div class="absolute inset-8">
                        <div id="game-grid" style="position: relative; width: 560px; height: 560px;">
                            <!-- Grid lines will be generated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Game Info Panel -->
            <div class="xl:w-96 w-full">
                <!-- Turn Indicator -->
                <div class="bg-white rounded-2xl p-6 shadow-xl mb-6 border border-gray-200">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-2xl font-light text-gray-800">Turn</h2>
                        <div id="turn-stone" class="w-16 h-16 black-stone rounded-full shadow-lg turn-indicator"></div>
                    </div>
                    <p id="turn-text" class="text-gray-600 text-lg">Black to play</p>
                </div>
                
                <!-- Game Info -->
                <div class="bg-white rounded-2xl p-6 shadow-xl mb-6 border border-gray-200">
                    <h2 class="text-2xl font-light text-gray-800 mb-4">Game Info</h2>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Moves</span>
                            <span id="move-count" class="font-medium">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Time</span>
                            <span id="game-time" class="font-medium">0:00</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Status</span>
                            <span id="game-status" class="font-medium text-green-600">Playing</span>
                        </div>
                    </div>
                </div>
                
                <!-- Players -->
                <div class="bg-white rounded-2xl p-6 shadow-xl mb-6 border border-gray-200">
                    <h2 class="text-2xl font-light text-gray-800 mb-4">Players</h2>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-xl">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 black-stone rounded-full"></div>
                                <span class="font-medium">Player 1 (Black)</span>
                            </div>
                            <span id="black-wins" class="text-2xl font-bold">0</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-xl">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 white-stone rounded-full border"></div>
                                <span class="font-medium">Player 2 (White)</span>
                            </div>
                            <span id="white-wins" class="text-2xl font-bold">0</span>
                        </div>
                    </div>
                </div>
                
                <!-- Actions -->
                <div class="space-y-4">
                    <button id="new-game-btn" class="w-full bg-black text-white py-4 px-6 rounded-2xl font-medium text-lg hover:bg-gray-800 transition-all shadow-lg">
                        New Game
                    </button>
                    <button id="undo-btn" class="w-full bg-gray-100 text-gray-800 py-4 px-6 rounded-2xl font-medium text-lg hover:bg-gray-200 transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                        Undo Move
                    </button>
                    <button id="resign-btn" class="w-full bg-red-500 text-white py-4 px-6 rounded-2xl font-medium text-lg hover:bg-red-600 transition-all">
                        Resign
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div id="game-over-modal" class="game-over-overlay hidden">
        <div class="bg-white rounded-3xl p-8 shadow-2xl text-center max-w-md mx-4">
            <div id="winner-stone" class="w-24 h-24 mx-auto mb-4 rounded-full shadow-lg"></div>
            <h2 id="winner-text" class="text-3xl font-bold mb-4 text-gray-800"></h2>
            <p id="game-summary" class="text-gray-600 mb-6"></p>
            <div class="flex gap-4">
                <button id="play-again-btn" class="flex-1 bg-black text-white py-3 px-6 rounded-xl font-medium hover:bg-gray-800 transition-all">
                    Play Again
                </button>
                <button id="close-modal-btn" class="flex-1 bg-gray-200 text-gray-800 py-3 px-6 rounded-xl font-medium hover:bg-gray-300 transition-all">
                    Close
                </button>
            </div>
        </div>
    </div>

    <script>
        class OmokGame {
            constructor() {
                this.board = Array(15).fill().map(() => Array(15).fill(0)); // 0: empty, 1: black, 2: white
                this.currentPlayer = 1; // 1: black, 2: white
                this.gameOver = false;
                this.moveHistory = [];
                this.gameStartTime = Date.now();
                this.gameTimer = null;
                this.wins = { black: 0, white: 0 };
                
                this.initializeBoard();
                this.initializeEventListeners();
                this.startGameTimer();
            }

            initializeBoard() {
                const gameGrid = document.getElementById('game-grid');
                gameGrid.innerHTML = '';

                // Create grid lines
                for (let i = 0; i <= 14; i++) {
                    // Horizontal lines
                    const hLine = document.createElement('div');
                    hLine.className = 'grid-line-h';
                    hLine.style.top = `${i * 40}px`;
                    gameGrid.appendChild(hLine);

                    // Vertical lines
                    const vLine = document.createElement('div');
                    vLine.className = 'grid-line-v';
                    vLine.style.left = `${i * 40}px`;
                    gameGrid.appendChild(vLine);
                }

                // Create star points
                const starPoints = [
                    [3, 3], [3, 7], [3, 11],
                    [7, 3], [7, 7], [7, 11],
                    [11, 3], [11, 7], [11, 11]
                ];

                starPoints.forEach(([row, col]) => {
                    const starPoint = document.createElement('div');
                    starPoint.className = 'star-point';
                    starPoint.style.top = `${row * 40 - 3}px`;
                    starPoint.style.left = `${col * 40 - 3}px`;
                    gameGrid.appendChild(starPoint);
                });

                // Create intersections
                for (let row = 0; row < 15; row++) {
                    for (let col = 0; col < 15; col++) {
                        const intersection = document.createElement('div');
                        intersection.className = 'intersection';
                        intersection.style.top = `${row * 40 - 20}px`;
                        intersection.style.left = `${col * 40 - 20}px`;
                        intersection.dataset.row = row;
                        intersection.dataset.col = col;
                        
                        intersection.addEventListener('click', () => this.makeMove(row, col));
                        gameGrid.appendChild(intersection);
                    }
                }
            }

            makeMove(row, col) {
                if (this.gameOver || this.board[row][col] !== 0) {
                    return false;
                }

                // Place stone
                this.board[row][col] = this.currentPlayer;
                this.moveHistory.push({ row, col, player: this.currentPlayer });

                // Update visual
                const intersection = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
                intersection.classList.add('occupied');
                
                const stone = document.createElement('div');
                stone.className = `stone ${this.currentPlayer === 1 ? 'black-stone' : 'white-stone'}`;
                intersection.appendChild(stone);

                // Check for win
                if (this.checkWin(row, col)) {
                    this.endGame(this.currentPlayer);
                    return true;
                }

                // Check for draw
                if (this.moveHistory.length === 225) {
                    this.endGame(0); // Draw
                    return true;
                }

                // Switch players
                this.currentPlayer = this.currentPlayer === 1 ? 2 : 1;
                this.updateUI();

                return true;
            }

            checkWin(row, col) {
                const player = this.board[row][col];
                const directions = [
                    [0, 1], [1, 0], [1, 1], [1, -1] // horizontal, vertical, diagonal1, diagonal2
                ];

                for (const [dx, dy] of directions) {
                    let count = 1;
                    const winningStones = [{row, col}];

                    // Check positive direction
                    for (let i = 1; i < 5; i++) {
                        const newRow = row + i * dx;
                        const newCol = col + i * dy;
                        if (newRow >= 0 && newRow < 15 && newCol >= 0 && newCol < 15 && 
                            this.board[newRow][newCol] === player) {
                            count++;
                            winningStones.push({row: newRow, col: newCol});
                        } else {
                            break;
                        }
                    }

                    // Check negative direction
                    for (let i = 1; i < 5; i++) {
                        const newRow = row - i * dx;
                        const newCol = col - i * dy;
                        if (newRow >= 0 && newRow < 15 && newCol >= 0 && newCol < 15 && 
                            this.board[newRow][newCol] === player) {
                            count++;
                            winningStones.unshift({row: newRow, col: newCol});
                        } else {
                            break;
                        }
                    }

                    if (count >= 5) {
                        this.highlightWinningStones(winningStones.slice(0, 5));
                        return true;
                    }
                }

                return false;
            }

            highlightWinningStones(stones) {
                stones.forEach(({row, col}) => {
                    const intersection = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
                    const stone = intersection.querySelector('.stone');
                    if (stone) {
                        stone.classList.add('winning-stone');
                    }
                });
            }

            endGame(winner) {
                this.gameOver = true;
                clearInterval(this.gameTimer);

                if (winner > 0) {
                    if (winner === 1) {
                        this.wins.black++;
                    } else {
                        this.wins.white++;
                    }
                }

                this.updateUI();
                this.showGameOverModal(winner);
            }

            showGameOverModal(winner) {
                const modal = document.getElementById('game-over-modal');
                const winnerStone = document.getElementById('winner-stone');
                const winnerText = document.getElementById('winner-text');
                const gameSummary = document.getElementById('game-summary');

                if (winner === 0) {
                    winnerStone.className = 'w-24 h-24 mx-auto mb-4 rounded-full shadow-lg bg-gray-400';
                    winnerText.textContent = 'Game Draw!';
                    gameSummary.textContent = 'The board is full with no winner.';
                } else {
                    winnerStone.className = `w-24 h-24 mx-auto mb-4 rounded-full shadow-lg ${winner === 1 ? 'black-stone' : 'white-stone'}`;
                    winnerText.textContent = `${winner === 1 ? 'Black' : 'White'} Wins!`;
                    gameSummary.textContent = `Congratulations! Game completed in ${this.moveHistory.length} moves.`;
                }

                modal.classList.remove('hidden');
            }

            undoMove() {
                if (this.moveHistory.length === 0 || this.gameOver) {
                    return false;
                }

                const lastMove = this.moveHistory.pop();
                this.board[lastMove.row][lastMove.col] = 0;

                // Remove stone from UI
                const intersection = document.querySelector(`[data-row="${lastMove.row}"][data-col="${lastMove.col}"]`);
                intersection.classList.remove('occupied');
                const stone = intersection.querySelector('.stone');
                if (stone) {
                    stone.remove();
                }

                // Switch back to previous player
                this.currentPlayer = lastMove.player;
                this.updateUI();

                return true;
            }

            newGame() {
                this.board = Array(15).fill().map(() => Array(15).fill(0));
                this.currentPlayer = 1;
                this.gameOver = false;
                this.moveHistory = [];
                this.gameStartTime = Date.now();
                
                this.initializeBoard();
                this.updateUI();
                this.startGameTimer();

                // Hide modal
                document.getElementById('game-over-modal').classList.add('hidden');
            }

            resign() {
                if (this.gameOver) return;

                const winner = this.currentPlayer === 1 ? 2 : 1;
                this.endGame(winner);
            }

            updateUI() {
                // Update turn indicator
                const turnStone = document.getElementById('turn-stone');
                const turnText = document.getElementById('turn-text');
                
                if (this.gameOver) {
                    turnText.textContent = 'Game Over';
                    turnStone.className = 'w-16 h-16 rounded-full shadow-lg bg-gray-400 turn-indicator';
                } else {
                    turnStone.className = `w-16 h-16 rounded-full shadow-lg turn-indicator ${this.currentPlayer === 1 ? 'black-stone' : 'white-stone'}`;
                    turnText.textContent = `${this.currentPlayer === 1 ? 'Black' : 'White'} to play`;
                }

                // Update move count
                document.getElementById('move-count').textContent = this.moveHistory.length;

                // Update game status
                const gameStatus = document.getElementById('game-status');
                if (this.gameOver) {
                    gameStatus.textContent = 'Finished';
                    gameStatus.className = 'font-medium text-red-600';
                } else {
                    gameStatus.textContent = 'Playing';
                    gameStatus.className = 'font-medium text-green-600';
                }

                // Update win counts
                document.getElementById('black-wins').textContent = this.wins.black;
                document.getElementById('white-wins').textContent = this.wins.white;

                // Update undo button
                const undoBtn = document.getElementById('undo-btn');
                undoBtn.disabled = this.moveHistory.length === 0 || this.gameOver;
            }

            startGameTimer() {
                clearInterval(this.gameTimer);
                this.gameTimer = setInterval(() => {
                    if (!this.gameOver) {
                        const elapsed = Math.floor((Date.now() - this.gameStartTime) / 1000);
                        const minutes = Math.floor(elapsed / 60);
                        const seconds = elapsed % 60;
                        document.getElementById('game-time').textContent = 
                            `${minutes}:${seconds.toString().padStart(2, '0')}`;
                    }
                }, 1000);
            }

            initializeEventListeners() {
                document.getElementById('new-game-btn').addEventListener('click', () => this.newGame());
                document.getElementById('undo-btn').addEventListener('click', () => this.undoMove());
                document.getElementById('resign-btn').addEventListener('click', () => this.resign());
                document.getElementById('play-again-btn').addEventListener('click', () => this.newGame());
                document.getElementById('close-modal-btn').addEventListener('click', () => {
                    document.getElementById('game-over-modal').classList.add('hidden');
                });
            }
        }

        // Initialize game when page loads
        document.addEventListener('DOMContentLoaded', () => {
            window.omokGame = new OmokGame();
        });
    </script>
</body>
</html>